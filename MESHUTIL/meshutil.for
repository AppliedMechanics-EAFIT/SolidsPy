CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C                                                                      C
C----M  E  S  H       U  T  I  L  I  T  I  E  S   B  L  O  C  K  ------C
C                                                                      C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C23456789012345678901234567890123456789012345678901234567890123456789012
C23456789012345678901234567890123456789012345678901234567890123456789012
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C                                                                      C
C   SUBROUTINE NODSECT                                                 C
C                                                                      C
C                                                                      C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C23456789012345678901234567890123456789012345678901234567890123456789012
C
      SUBROUTINE NODSECT(IIN,INOD)
C
      IMPLICIT REAL*8 (A-H,O-Z)
C
      CHARACTER*10 FGAR
      ALLOCATABLE COORD(:,:)
C
      READ(IIN, *) FGAR
      READ(IIN, *) GAR,GAR
      READ(IIN, *) FGAR
      READ(IIN, *) FGAR
      READ(IIN, *) NUMNP
C
      ALLOCATE (COORD(2,NUMNP))
      CALL CLEAR(COORD,2,NUMNP)

C
      x1=-18000
      x2=-18000
      y1=-18000
      y2=-18000
C
      DO I=1,NUMNP
         iflag=1
         READ (IIN,    *) N,(COORD(JJ,I),JJ=1,2),CGAR1
         CALL CHECKBC(x1,x2,y1,y2,iflag,COORD(1,I),COORD(2,I))
C
         IF(iflag.EQ.0) THEN
            WRITE(INOD,1010) N-1,(COORD(JJ,I),JJ=1,2),-1,-1
         else
            WRITE(INOD,1010) N-1,(COORD(JJ,I),JJ=1,2),0,0
         end if
      END DO
C
 1010 FORMAT(I5,10X,F12.6,10X,F12.6,10X,I5,10X,I5)
C
      RETURN
C
      END
C
C23456789012345678901234567890123456789012345678901234567890123456789012
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C                                                                      C
C   SUBROUTINE LINQUAD                                                 C
C                                                                      C
C                                                                      C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C23456789012345678901234567890123456789012345678901234567890123456789012
      SUBROUTINE LINQUAD(IIN,IELE,NUMEL,IE)
C
      IMPLICIT REAL*8 (A-H,O-Z)
C
      DO I=1,NUMEL
         READ (IIN,    *) N,IGAR1,IGAR2,IGAR3,IM,N1,N2,N3,N4
         WRITE(IELE,1020) N-1,IE,IM-1,N1-1,N2-1,N3-1,N4-1
      END DO
C
 1020 FORMAT(I5,5X,I5,5X,I5,5X,I5,5X,I5,5X,I5,5X,I5)
C
      RETURN
C
      END
C
C23456789012345678901234567890123456789012345678901234567890123456789012
C23456789012345678901234567890123456789012345678901234567890123456789012
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C                                                                      C
C   SUBROUTINE QADTRIAN                                                C
C                                                                      C
C                                                                      C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C23456789012345678901234567890123456789012345678901234567890123456789012
      SUBROUTINE QADTRIAN(IIN,IELE,NUMEL,IE)
C
      IMPLICIT REAL*8 (A-H,O-Z)
C
      DO I=1,NUMEL
         READ (IIN,    *) N,IGAR1,IGAR2,IGAR3,IM,N1,N2,N3,N4,N5,N6
         WRITE(IELE,1020) N-1,IE,IM-1,N1-1,N2-1,N3-1,N4-1,N5-1,N6-1
      END DO
C
 1020 FORMAT(I5,5X,I5,5X,I5,5X,I5,5X,I5,5X,I5,5X,I5,5X,I5,5X,I5)
C
      RETURN
C
      END
C
C
C23456789012345678901234567890123456789012345678901234567890123456789012
C23456789012345678901234567890123456789012345678901234567890123456789012
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C                                                                      C
C   SUBROUTINE QADTRIAN                                                C
C                                                                      C
C                                                                      C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C23456789012345678901234567890123456789012345678901234567890123456789012
      SUBROUTINE LINTRIAN(IIN,IELE,NUMEL,IE)
C
      IMPLICIT REAL*8 (A-H,O-Z)
C
      DO I=1,NUMEL
         READ (IIN,    *) N,IGAR1,IGAR2,IGAR3,IM,N1,N2,N3
         WRITE(IELE,1020) N-1,IE,IM-1,N1-1,N2-1,N3-1
      END DO
C
 1020 FORMAT(I5,5X,I5,5X,I5,5X,I5,5X,I5,5X,I5,5X)
C
      RETURN
C
      END
C
C23456789012345678901234567890123456789012345678901234567890123456789012
C23456789012345678901234567890123456789012345678901234567890123456789012
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C                                                                      C
C   SUBROUTINE CHECKBC                                                 C
C                                                                      C
C                                                                      C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C23456789012345678901234567890123456789012345678901234567890123456789012
      SUBROUTINE CHECKBC(x1,x2,y1,y2,iflag,x,y)
C
      IMPLICIT REAL*8 (A-H,O-Z)
C
      if(x.eq.x1) then
        iflag=0
      end if
C
      if(x.eq.x2) then
        iflag=0
      end if
C
C
      if(y.eq.y1) then
        iflag=0
      end if
C
C
      if(y.eq.y2) then
        iflag=0
      end if

C
      return
C
      END










